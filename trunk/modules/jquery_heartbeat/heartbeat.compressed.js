// $Id:
$.jheartbeat={options:{url:'heartbeat.php',delay:10000,div_id:'heartbeat',replace:true,lbl_start:'Start',lbl_stop:'Stop'},beatfunction:function(){},timeoutobj:{id:-1},set:function(options,onbeatfunction){if(this.timeoutobj.id>-1){clearTimeout(this.timeoutobj.id)}if(options){$.extend(this.options,options)}if(onbeatfunction){this.beatfunction=onbeatfunction}if($('#'+this.options.div_id).length<1){$('body').append('<div id="'+this.options.div_id+'" style="display: none;"></div>')}this.timeoutobj.id=setTimeout('$.jheartbeat.beat();',this.options.delay)},startstop:function(oBtn,sMode){if(sMode!='start'&&sMode!='stop'){sMode=(this.timeoutobj.id>-1)?'stop':'start'}if(sMode=='start'){if(this.timeoutobj.id>-1){clearTimeout(this.timeoutobj.id)}$('#'+oBtn.id).html(this.options.lbl_stop);$('#'+oBtn.id).css({backgroundColor:'maroon',color:'white'});this.timeoutobj.id=setTimeout('$.jheartbeat.beat();',this.options.delay)}else{if(this.timeoutobj.id>-1){clearTimeout(this.timeoutobj.id)}this.timeoutobj.id=-1;$('#'+oBtn.id).html(this.options.lbl_start);$('#'+oBtn.id).css({backgroundColor:'green',color:'white'})}},beat:function(){$.ajax({url:this.options.url,dataType:'html',type:'GET',error:function(e){var sMsg='<span class="error">Error</span>';if($.jheartbeat.options.replace){$('#'+$.jheartbeat.options.div_id).html(sMsg)}else{$('#'+$.jheartbeat.options.div_id).append(sMsg)}},success:function(data){if($.jheartbeat.options.replace){$('#'+$.jheartbeat.options.div_id).html(data)}else{$('#'+$.jheartbeat.options.div_id).append(data)}}});this.timeoutobj.id=setTimeout('$.jheartbeat.beat();',this.options.delay);this.beatfunction()}};